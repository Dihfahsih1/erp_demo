{% load custom_tags %}
{% load static %}
<aside class="app-sidebar shadow" data-bs-theme="dark">
  <div class="sidebar-brand">
    <a href="{% url 'dashboard' %}" class="brand-link">
      <img src="{% static 'img/Logo.png' %}" alt="AutoZone Logo" class="brand-image opacity-75 shadow">
      <span class="brand-text fw-light">Auto Pro Master</span>
    </a>
  </div>
  <div class="sidebar-wrapper">
    <div class="card shadow-sm mb-3 border-0 rounded-4 bg-light">
      <div class="card-body d-flex align-items-start">
        <div class="me-2">
          <i class="bi bi-person-circle fs-4 text-primary"></i>
        </div>
        <div class="flex-grow-1">
          <h6 class="mb-1 text-muted fw-bold">
            <i class="bi bi-shield-lock-fill text-secondary me-1"></i>Logged in as:
          </h6>
          <p class="mb-1 text-dark fw-semibold">
            {{ request.user.get_full_name|default:request.user.username }}
          </p>
          <div class="d-flex flex-wrap gap-1">
            <span class="badge bg-success">
              <i class="bi bi-award-fill me-1"></i>{{ request.user.role.name }}
            </span>
            <span class="badge bg-info text-dark">
              <i class="bi bi-building me-1"></i>{{ request.user.department.name }}
            </span>
          </div>
        </div>
      </div>
    </div>
    <nav>
      <ul class="nav sidebar-menu flex-column" data-lte-toggle="treeview" role="menu" data-accordion="false">
        <li class="nav-item">
          <a class="nav-link active" href="{% url 'sales_dashboard' %}">
            <i class="bi bi-speedometer2"></i>
            <span class="nav-link-text">Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'customer_ledger' %}">
            <i class="bi bi-cart-plus"></i>
            <span class="nav-link-text">Customer Ledger</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="bi bi-list-check"></i>
            <span class="nav-link-text">My Orders</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="bi bi-truck"></i>
            <span class="nav-link-text">Delivery Notes</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="bi bi-people"></i>
            <span class="nav-link-text">Customer Contacts</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="bi bi-file-earmark-text"></i>
            <span class="nav-link-text">Price List</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="bi bi-graph-up"></i>
            <span class="nav-link-text">Item Movement</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="bi bi-clipboard-data"></i>
            <span class="nav-link-text">Weekly Reports</span>
          </a>
        </li>
        <li class="nav-item mt-2">
          <a class="nav-link" href="#">
            <i class="bi bi-gear"></i>
            <span class="nav-link-text">Settings</span>
          </a>
        </li>

        {% if request.user.role and request.user.role.name in 'CRM Officer,Estimates Officer,Credit Officer' %}
          <li class="nav-header">CUSTOMERS</li>
          <li class="nav-item">
            <a href="{% url 'register_customer' %}" class="nav-link">
              <i class="bi bi-person-plus"></i>
              <span class="nav-link-text">Register Customer</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'customer_list' %}" class="nav-link">
              <i class="bi bi-people"></i>
              <span class="nav-link-text">List Of Customers</span>
            </a>
          </li>
          {% if request.user.role and request.user.role.name in 'Estimates Officer,Credit Officer' %}
            <li class="nav-header">ESTIMATES</li>
            <li class="nav-item">
              <a href="{% url 'record_estimate' %}" class="nav-link">
                <i class="bi bi-pencil-square"></i>
                <span class="nav-link-text">Record Estimate</span>
              </a>
            </li>
          {% endif %}
        {% endif %}

        {% if request.user.role and request.user.role.name in 'CRM Officer,Delivery Officer,Estimates Officer,Billing Officer,Credit Officer,Dispatch Officer' %}
          <li class="nav-item">
            <a href="{% url 'list_estimates' %}" class="nav-link">
              <i class="bi bi-list-ul"></i>
              <span class="nav-link-text">List Of Estimates</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'billed_estimates_list' %}" class="nav-link">
              <i class="bi bi-clipboard-data"></i>
              <span class="nav-link-text">Billed Estimates</span>
            </a>
          </li>
        {% endif %}

        {% if request.user.role and request.user.role.name == 'Delivery Officer' %}
          <li class="nav-header">DELIVERY NOTES</li>
          <li class="nav-item">
            <a href="{% url 'delivery_note_list' %}" class="nav-link">
              <i class="bi bi-clipboard-data"></i>
              <span class="nav-link-text">Delivery Notes</span>
            </a>
          </li>
        {% endif %}

        {% if request.user.role and request.user.role.name == 'Sales Officer' %}
          <li class="nav-item">
            <a href="{% url 'delivery_note_list_by_sales_person' %}" class="nav-link">
              <i class="bi bi-file-earmark-person"></i>
              <span class="nav-link-text">My Delivery Notes</span>
            </a>
          </li>
        {% endif %}

        {% if request.user.role and request.user.role.name in 'Delivery Officer,Dispatch Officer' %}
          <li class="nav-header">TRANSPORTATION</li>
          <li class="nav-item">
            <a href="{% url 'mark_dispatch_delivered' %}" class="nav-link">
              <i class="bi bi-box-seam"></i>
              <span class="nav-link-text">Create Courier Details</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'dispatch_list' %}" class="nav-link">
              <i class="bi bi-card-list"></i>
              <span class="nav-link-text">List Courier Details</span>
            </a>
          </li>
        {% endif %}

        {% if request.user.role and request.user.role.name in 'Dispatch Officer,Delivery Officer' %}
          <li class="nav-header">DISPATCH VERIFICATION</li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="bi bi-send-check text-danger"></i>
              <span class="nav-link-text">Record Dispatch</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="bi bi-check2-circle text-warning"></i>
              <span class="nav-link-text">Dispatched Items</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="bi bi-bar-chart-line text-info"></i>
              <span class="nav-link-text">Reports</span>
            </a>
          </li>
        {% endif %}

        {% if user.is_authenticated %}
          <li class="nav-item mt-2">
            <a class="nav-link text-danger fw-semibold" href="{% url 'log_out' %}">
              <i class="bi bi-box-arrow-right me-2 fs-5"></i>
              <span class="nav-link-text">Logout</span>
            </a>
          </li>
        {% endif %}
      </ul>
    </nav>
  </div>
</aside>